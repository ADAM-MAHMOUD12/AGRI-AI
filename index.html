<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸŒ± Ù…Ù†ØµØ© Ø§Ù„Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠØ© - Agri-AI</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet" />
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'primary-green': { 600: '#16a34a', 700: '#15803d', 800: '#14532d', 50: '#f0fdf4' },
            'secondary-blue': { 600: '#2563eb', 700: '#1d4ed8', 50: '#eff6ff' },
            'accent-yellow': '#facc15',
            'soft-gray': '#f8fafc'
          },
          fontFamily: { sans: ['Inter', 'sans-serif'] }
        }
      }
    };
  </script>
  <style>
    input:focus, select:focus {
      border-color: #16a34a;
      box-shadow: 0 0 0 3px rgba(22, 163, 74, 0.3);
    }
    .fade-in {
      animation: fadeIn 0.8s ease-in-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen p-4 sm:p-8 font-sans">
  <div class="max-w-6xl mx-auto">

    <!-- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† -->
    <header class="text-center mb-10 p-8 bg-white rounded-3xl shadow-2xl border-t-8 border-primary-green-600">
      <h1 class="text-4xl sm:text-6xl font-black text-primary-green-800 mb-3">
        ğŸŒ± Ù…Ù†ØµØ© Ø§Ù„Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠØ© (<span class="text-secondary-blue-600">Agri-AI</span>)
      </h1>
      <p class="text-gray-600 text-xl font-medium">
        Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„ØªØ­Ù„ÙŠÙ„ ÙˆØªØ­Ø³ÙŠÙ† Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ù…Ø²Ø±Ø¹Ø© Ø¨ÙƒÙØ§Ø¡Ø© ÙˆØ°ÙƒØ§Ø¡.
      </p>
    </header>

    <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ -->
    <div class="bg-white p-6 sm:p-10 rounded-3xl shadow-2xl mb-12 border-l-4 border-primary-green-600">
      <h2 class="text-3xl font-extrabold text-primary-green-700 mb-8 border-b-2 pb-4 border-gray-200">ğŸ§  Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø²Ø±Ø¹Ø© Ù„Ù„ØªØ­Ù„ÙŠÙ„</h2>
      <form id="farm-data-form" class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div>
          <label class="block mb-2 font-semibold text-gray-700">ğŸŒ¾ Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ØµÙˆÙ„:</label>
          <input id="crop_type" value="Ø·Ù…Ø§Ø·Ù…" required class="w-full p-4 border rounded-xl" />
        </div>
        <div>
          <label class="block mb-2 font-semibold text-gray-700">ğŸŒ Ø­Ø¬Ù… Ø§Ù„Ø­Ù‚Ù„ (Ù…Â²):</label>
          <input id="field_size" type="number" value="10000" required class="w-full p-4 border rounded-xl" />
        </div>
        <div>
          <label class="block mb-2 font-semibold text-gray-700">ğŸ§± Ù†ÙˆØ¹ Ø§Ù„ØªØ±Ø¨Ø©:</label>
          <select id="soil_type" class="w-full p-4 border rounded-xl">
            <option>Ø·ÙŠÙ†ÙŠØ©</option><option>Ø±Ù…Ù„ÙŠØ©</option><option>Ø·Ù…ÙŠÙŠØ©</option><option>Ø¬ÙŠØ±ÙŠØ©</option>
          </select>
        </div>
        <div>
          <label class="block mb-2 font-semibold text-gray-700">ğŸ’§ Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ Ø§Ù„Ù…ÙŠØ§Ù‡ (Ù…Â³/Ø£Ø³Ø¨ÙˆØ¹):</label>
          <input id="current_water" type="number" value="150" required class="w-full p-4 border rounded-xl" />
        </div>
        <div class="md:col-span-2">
          <label class="block mb-2 font-semibold text-gray-700">ğŸ§ª Ù†ÙˆØ¹ ÙˆÙƒÙ…ÙŠØ© Ø§Ù„Ø³Ù…Ø§Ø¯:</label>
          <input id="current_fertilizer" value="NPK 20-20-20 Ø¨Ù…Ù‚Ø¯Ø§Ø± 5 Ø¬Ù…/Ù…Â²" class="w-full p-4 border rounded-xl" />
        </div>
        <div class="md:col-span-2 mt-6">
          <button id="analyze-button" type="submit" class="w-full bg-primary-green-600 text-white font-bold text-xl py-4 rounded-xl shadow-lg hover:bg-primary-green-700 transition-all duration-300">
            ğŸš€ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
          </button>
        </div>
      </form>
    </div>

    <!-- Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
    <div id="loading-state" class="hidden text-center text-xl font-bold text-primary-green-700 animate-pulse">
      â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª... Ù†Ø±Ø¬Ùˆ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù‚Ù„ÙŠÙ„Ù‹Ø§.
    </div>

    <!-- Ø§Ù„Ù†ØªØ§Ø¦Ø¬ -->
    <div id="results-section" class="hidden bg-white p-6 sm:p-10 rounded-3xl shadow-2xl border-l-4 border-secondary-blue-600 fade-in">
      <h2 class="text-3xl font-extrabold text-secondary-blue-700 mb-8 border-b-2 pb-4 border-gray-200">ğŸ“Š Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ù„ÙŠÙ„</h2>

      <!-- Ø¨Ø·Ø§Ù‚Ø§Øª Ù†Ø³Ø¨ Ø§Ù„ØªØ­Ø³ÙŠÙ† -->
      <div id="stats-cards" class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-10">
        <!-- ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¹Ø¨Ø± JS -->
      </div>

      <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªÙˆØµÙŠØ§Øª -->
      <div id="recommendation-table" class="mb-8"></div>

      <!-- Ø´Ø±Ø­ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ -->
      <div id="ai-output" class="bg-soft-gray p-6 rounded-2xl shadow-inner text-gray-700 text-lg leading-relaxed whitespace-pre-line"></div>
    </div>

    <footer class="text-center mt-12 text-gray-500 text-sm">
      <p>ğŸŒ¿ <span class="font-semibold text-primary-green-700">Agri-AI</span> - Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠ Ø§Ù„Ø°ÙƒÙŠ Â© 2025</p>
    </footer>
  </div>

  <script>
    const apiUrl = "https://agri-ai.adammaan41.workers.dev";

    const form = document.getElementById("farm-data-form");
    const loadingState = document.getElementById("loading-state");
    const resultsSection = document.getElementById("results-section");
    const aiOutput = document.getElementById("ai-output");
    const statsCards = document.getElementById("stats-cards");
    const recommendationTable = document.getElementById("recommendation-table");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      resultsSection.classList.add("hidden");
      loadingState.classList.remove("hidden");

      const payload = {
        crop_type: crop_type.value,
        field_size: field_size.value,
        soil_type: soil_type.value,
        current_water: current_water.value,
        current_fertilizer: current_fertilizer.value
      };

      try {
        const response = await fetch(apiUrl, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });

        const data = await response.json();
        const text = data.message || "Ù„Ù… ÙŠØªÙ… ØªÙ„Ù‚ÙŠ Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù….";

        // ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¥Ù„Ù‰ Ø£Ø¬Ø²Ø§Ø¡
        aiOutput.textContent = text;

        // Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù†Ø³Ø¨ (Ø¹ÙŠÙ†Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ© â€” ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§ Ø­Ø³Ø¨ Ù…Ø®Ø±Ø¬Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ)
        statsCards.innerHTML = `
          <div class="bg-primary-green-50 p-5 rounded-2xl shadow text-center border-b-4 border-primary-green-600">
            <h3 class="text-2xl font-bold text-primary-green-700">ğŸ’§ 25%</h3>
            <p class="text-gray-600 font-semibold">ØªÙˆÙÙŠØ± Ø§Ù„Ù…ÙŠØ§Ù‡</p>
          </div>
          <div class="bg-secondary-blue-50 p-5 rounded-2xl shadow text-center border-b-4 border-secondary-blue-600">
            <h3 class="text-2xl font-bold text-secondary-blue-700">ğŸŒ¿ 18%</h3>
            <p class="text-gray-600 font-semibold">ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø³Ù…Ø§Ø¯</p>
          </div>
          <div class="bg-yellow-50 p-5 rounded-2xl shadow text-center border-b-4 border-yellow-400">
            <h3 class="text-2xl font-bold text-yellow-600">ğŸŒ¾ 12%</h3>
            <p class="text-gray-600 font-semibold">Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø­ØµÙˆÙ„</p>
          </div>
          <div class="bg-red-50 p-5 rounded-2xl shadow text-center border-b-4 border-red-400">
            <h3 class="text-2xl font-bold text-red-600">ğŸ’° 15%</h3>
            <p class="text-gray-600 font-semibold">Ø®ÙØ¶ Ø§Ù„ØªÙƒÙ„ÙØ©</p>
          </div>
        `;

        // Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªÙˆØµÙŠØ§Øª
        recommendationTable.innerHTML = `
          <table class="w-full text-center border-collapse rounded-xl overflow-hidden shadow">
            <thead class="bg-secondary-blue-600 text-white">
              <tr>
                <th class="p-3">Ø§Ù„Ø¹Ù†ØµØ±</th>
                <th class="p-3">Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©</th>
                <th class="p-3">Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©</th>
                <th class="p-3">Ø§Ù„ØªØ­Ø³ÙŠÙ†</th>
              </tr>
            </thead>
            <tbody class="bg-white">
              <tr class="border-b">
                <td class="p-3 font-semibold">Ø§Ù„Ù…ÙŠØ§Ù‡</td>
                <td class="p-3">${payload.current_water} Ù…Â³</td>
                <td class="p-3">${(payload.current_water * 0.75).toFixed(1)} Ù…Â³</td>
                <td class="p-3 text-primary-green-700 font-bold">ØªÙˆÙÙŠØ± 25%</td>
              </tr>
              <tr>
                <td class="p-3 font-semibold">Ø§Ù„Ø³Ù…Ø§Ø¯</td>
                <td class="p-3">${payload.current_fertilizer}</td>
                <td class="p-3">Ø®ÙØ¶ Ø¨Ù…Ù‚Ø¯Ø§Ø± 20%</td>
                <td class="p-3 text-primary-green-700 font-bold">ØªØ­Ø³ÙŠÙ† Ø§Ù„ÙƒÙØ§Ø¡Ø©</td>
              </tr>
            </tbody>
          </table>
        `;

      } catch (err) {
        aiOutput.innerHTML = `<p class='text-red-600'>âš ï¸ Ø®Ø·Ø£: ${err.message}</p>`;
      } finally {
        loadingState.classList.add("hidden");
        resultsSection.classList.remove("hidden");
        resultsSection.scrollIntoView({ behavior: "smooth" });
      }
    });
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸŒ± Ù…Ù†ØµØ© Ø§Ù„Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠØ© - Ù…Ø¹Ù‹Ø§ Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ø²Ø±Ø§Ø¹ÙŠ Ø±Ù‚Ù…ÙŠ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet" />
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'primary-green': { 600: '#16a34a', 700: '#15803d', 800: '#14532d', 50: '#f0fdf4' },
            'secondary-blue': { 600: '#2563eb', 700: '#1d4ed8', 50: '#eff6ff' },
            'accent-yellow': '#facc15',
          },
          fontFamily: { sans: ['Inter', 'sans-serif'] },
        },
      },
    };
  </script>
  <style>
    body {
      background: linear-gradient(135deg, #e8f5e9 0%, #f0fdf4 50%, #e6fffa 100%);
    }
    input, select {
      color: #15803d;
    }
    #rotating-tip-card, #impact-image-section { transition: opacity 0.8s ease-in-out; }
  </style>
</head>
<body class="min-h-screen p-4 sm:p-8 font-sans">
  <div id="app" class="max-w-6xl mx-auto">
    <div class="text-center mb-6">
      <h2 class="text-2xl font-extrabold text-secondary-blue-700 bg-secondary-blue-50 p-3 rounded-full inline-block shadow-md">
        ğŸ¤ Ù…Ø¹Ù‹Ø§ Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ø²Ø±Ø§Ø¹ÙŠ Ø±Ù‚Ù…ÙŠ ğŸŒ¾
      </h2>
    </div>
    <header class="text-center mb-10 p-8 bg-white rounded-3xl shadow-2xl border-t-8 border-primary-green-600">
      <h1 class="text-5xl sm:text-6xl font-black text-primary-green-800 mb-3">
        ğŸŒ± Ù…Ù†ØµØ© Ø§Ù„Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠØ© (<span class="text-secondary-blue-600">Agri-AI</span>)
      </h1>
      <p class="text-gray-600 text-xl font-medium">
        ØªØ­Ù„ÙŠÙ„ Ù…ØªÙ‚Ø¯Ù… Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„ØªØ­Ø³ÙŠÙ† ÙƒÙØ§Ø¡Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙŠØ§Ù‡ ÙˆØ§Ù„Ø£Ø³Ù…Ø¯Ø©.
      </p>
    </header>
    <div id="impact-image-section" class="mb-12 rounded-3xl overflow-hidden shadow-2xl border-4 border-gray-200">
      <img id="impact-image" src="https://placehold.co/1200x400/15803d/ffffff?text=AGRI-AI" alt="Agri-AI" class="w-full h-auto object-cover" />
    </div>
    <div class="mb-12">
      <h2 class="text-2xl font-bold text-secondary-blue-700 mb-4 text-center">ğŸ’¡ Ù†ØµØ§Ø¦Ø­ Ø¥Ø±Ø´Ø§Ø¯ÙŠØ© Ù…Ù† Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</h2>
      <div id="rotating-tip-card" class="bg-white rounded-2xl shadow-lg p-6 flex flex-col md:flex-row items-center justify-between border-4 border-secondary-blue-50">
        <div class="md:w-1/3 w-full mb-4 md:mb-0">
          <img id="tip-image" src="https://placehold.co/800x400/14532d/ffffff?text=LOADING" class="w-full rounded-xl shadow-md object-cover" />
        </div>
        <div class="md:w-2/3 w-full">
          <p id="tip-text" class="text-xl font-semibold text-gray-800 text-center md:text-right p-4 bg-primary-green-50 rounded-xl border-r-4 border-primary-green-600">
            Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†ØµØ§Ø¦Ø­ Ø§Ù„Ø°ÙƒÙŠØ©...
          </p>
        </div>
      </div>
    </div>
    <div class="bg-white p-6 sm:p-10 rounded-3xl shadow-2xl mb-12 border-l-4 border-primary-green-600">
      <h2 class="text-3xl font-extrabold text-primary-green-700 mb-8">Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø²Ø±Ø¹Ø© Ù„Ù„ØªØ­Ù„ÙŠÙ„ ğŸ¤–</h2>
      <form id="farm-data-form" class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div>
          <label class="block mb-2 font-semibold text-gray-700">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ØµÙˆÙ„:</label>
          <input id="crop_type" value="Ø·Ù…Ø§Ø·Ù…" required class="w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary-green-600 transition" />
        </div>
        <div>
          <label class="block mb-2 font-semibold text-gray-700">Ø­Ø¬Ù… Ø§Ù„Ø­Ù‚Ù„ (Ù…Â²):</label>
          <input id="field_size" type="number" value="10000" required class="w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary-green-600 transition" />
        </div>
        <div>
          <label class="block mb-2 font-semibold text-gray-700">Ù†ÙˆØ¹ Ø§Ù„ØªØ±Ø¨Ø©:</label>
          <select id="soil_type" class="w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary-green-600 transition">
            <option>Ø·ÙŠÙ†ÙŠØ©</option><option>Ø±Ù…Ù„ÙŠØ©</option><option>Ø·Ù…ÙŠÙŠØ©</option><option>Ø¬ÙŠØ±ÙŠØ©</option>
          </select>
        </div>
        <div>
          <label class="block mb-2 font-semibold text-gray-700">Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ù„Ù…ÙŠØ§Ù‡ (Ù…Â³/Ø£Ø³Ø¨ÙˆØ¹):</label>
          <input id="current_water" type="number" value="150" required class="w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary-green-600 transition" />
        </div>
        <div class="md:col-span-2">
          <label class="block mb-2 font-semibold text-gray-700">Ù†ÙˆØ¹ ÙˆÙƒÙ…ÙŠØ© Ø§Ù„Ø³Ù…Ø§Ø¯:</label>
          <input id="current_fertilizer" value="NPK 20-20-20 Ø¨Ù…Ù‚Ø¯Ø§Ø± 5 Ø¬Ù…/Ù…Â²" class="w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary-green-600 transition" />
        </div>
        <div class="md:col-span-2 mt-6">
          <button id="analyze-button" type="submit" class="w-full bg-primary-green-600 text-white font-bold text-xl py-4 rounded-xl shadow-lg hover:bg-primary-green-700 hover:shadow-xl transform hover:scale-[1.02] transition-all duration-300">
            <span id="button-text">ØªØ­Ù„ÙŠÙ„ ÙˆØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</span>
          </button>
        </div>
      </form>
    </div>
    <div id="loading-state" class="hidden bg-white p-10 rounded-3xl shadow-2xl mb-12 border-b-8 border-accent-yellow text-center animate-pulse">
      <p class="text-3xl font-extrabold text-primary-green-800 mb-3">Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
      <p class="text-xl text-gray-500">ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠÙ†ØªÙ‡ÙŠ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù…Ù† Ø§Ù„ØªØ­Ù„ÙŠÙ„.</p>
    </div>
    <div id="results-section" class="hidden bg-white p-6 sm:p-10 rounded-3xl shadow-2xl border-l-4 border-secondary-blue-600">
      <h2 class="text-3xl font-extrabold text-secondary-blue-700 mb-8 border-b-2 pb-4 border-gray-200">Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ù„ÙŠÙ„ ğŸ’¡</h2>
      <div id="ai-output" class="overflow-x-auto"></div>
    </div>
    <footer class="text-center mt-12 text-gray-500 text-sm">
      <p>Ù…Ø¯Ø¹ÙˆÙ… Ø¨ÙˆØ§Ø³Ø·Ø© <span class="text-secondary-blue-600 font-semibold">AGRI-AI</span></p>
    </footer>
  </div>
  <script>
    // ** ØªØ£ÙƒØ¯ Ø£Ù† Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· Ù‡Ùˆ Ø±Ø§Ø¨Ø· Cloudflare Worker Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ **
    const apiUrl = "https://agri-ai.adammaan41.workers.dev/"; 
    
    // ØµÙˆØ± Ù…ØªØºÙŠØ±Ø©
    const headerImages = [
      "https://placehold.co/1200x400/15803d/ffffff?text=AGRI-AI",
      "https://placehold.co/1200x400/2563eb/ffffff?text=AGRI-AI+ANALYTICS",
      "https://placehold.co/1200x400/facc15/000000?text=YIELD+OPTIMIZATION"
    ];
    let currentHeaderImage = 0;
    setInterval(() => {
      currentHeaderImage = (currentHeaderImage + 1) % headerImages.length;
      document.getElementById("impact-image").src = headerImages[currentHeaderImage];
    }, 7000);

    // Ù†ØµØ§Ø¦Ø­
    const tips = [
      { text: "Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø±ÙŠ Ø¨Ø§Ù„ØªÙ†Ù‚ÙŠØ· Ù„ØªÙ‚Ù„ÙŠÙ„ Ù‡Ø¯Ø± Ø§Ù„Ù…ÙŠØ§Ù‡ Ø¨Ù†Ø³Ø¨Ø© ØªØµÙ„ Ø¥Ù„Ù‰ 40%.", image: "https://placehold.co/800x400/16a34a/ffffff?text=SMART+IRRIGATION" },
      { text: "Ø­Ù„Ù„ Ø§Ù„ØªØ±Ø¨Ø© ÙƒÙ„ Ù…ÙˆØ³Ù… Ù„ØªÙˆÙÙŠØ± Ø­ØªÙ‰ 20% Ù…Ù† Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ.", image: "https://placehold.co/800x400/1d4ed8/ffffff?text=SOIL+HEALTH" },
      { text: "Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ© Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø¨Ù†Ø³Ø¨Ø© 300%.", image: "https://placehold.co/800x400/facc15/000000?text=VERTICAL+FARMING" }
    ];
    let currentTip = 0;
    setInterval(() => {
      currentTip = (currentTip + 1) % tips.length;
      document.getElementById("tip-text").textContent = tips[currentTip].text;
      document.getElementById("tip-image").src = tips[currentTip].image;
    }, 7000);
    
    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
    document.getElementById("farm-data-form").addEventListener("submit", async (e) => {
      e.preventDefault();
      
      // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙˆØ¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
      document.getElementById("results-section").classList.add("hidden");
      document.getElementById("loading-state").classList.remove("hidden");

      const payload = {
        crop_type: crop_type.value,
        field_size: field_size.value,
        soil_type: soil_type.value,
        current_water: current_water.value,
        current_fertilizer: current_fertilizer.value
      };

      try {
        const res = await fetch(apiUrl, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });

        const data = await res.json();
        
        // Ø¥Ø®ÙØ§Ø¡ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
        document.getElementById("loading-state").classList.add("hidden");
        document.getElementById("results-section").classList.remove("hidden");

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø®Ø·Ø£ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…
        if (data.error) throw new Error(data.error);

        // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙÙŠ Ø¬Ø¯ÙˆÙ„
        document.getElementById("ai-output").innerHTML = `
          <table class="min-w-full border border-gray-200 rounded-xl overflow-hidden">
            <tr class="bg-primary-green-50 text-primary-green-800 font-bold"><td class="p-4 border">Ø§Ù„Ù…Ù„Ø®Øµ</td><td class="p-4 border">${data.summary || 'Ù„Ù… ÙŠØªÙ… Ø¥Ø±Ø¬Ø§Ø¹ Ù†Øµ.'}</td></tr>
            <tr><td class="p-4 border font-semibold">ØªÙˆÙÙŠØ± Ø§Ù„Ù…ÙŠØ§Ù‡</td><td class="p-4 border">${data.water_saving || 0}%</td></tr>
            <tr><td class="p-4 border font-semibold">ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø£Ø³Ù…Ø¯Ø©</td><td class="p-4 border">${data.fertilizer_reduction || 0}%</td></tr>
            <tr><td class="p-4 border font-semibold">Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¥Ù†ØªØ§Ø¬</td><td class="p-4 border">${data.yield_increase || 0}%</td></tr>
          </table>`;

      } catch (err) {
        // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£
        document.getElementById("loading-state").classList.add("hidden");
        document.getElementById("results-section").classList.remove("hidden");
        document.getElementById("ai-output").innerHTML =
          `<p class="text-red-600 bg-red-50 border border-red-200 p-4 rounded-xl">âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£: ${err.message}</p>`;
      }
    });
  </script>
</body>
</html>
